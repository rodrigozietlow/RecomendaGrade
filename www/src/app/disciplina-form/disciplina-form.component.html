<form (submit)="salvarDisciplina()" [formGroup]="form" class="my-3">

	<div class="form-group">
		<label for="periodo">*{{provider.curso.nomePeriodos}}:</label>
		<input type="number" class="form-control" id="periodo" name="periodo" [(ngModel)]="objetoDisciplina.periodo" formControlName="periodo" placeholder="Digite o {{provider.curso.nomePeriodos | lowercase}}">
	</div>
	<div *ngIf="form.controls['periodo'].invalid && (form.controls['periodo'].dirty || form.controls['periodo'].touched)" class="alert alert-danger" role="alert">
		<strong>Erros:</strong>
		<div *ngIf="form.controls['periodo'].errors.required">
			Você deve preencher este campo
		</div>
		<div *ngIf="form.controls['periodo'].errors.max">
			O curso possui o máximo de {{provider.curso.qtPeriodos}} {{provider.curso.nomePeriodos | lowercase}}s. Informe um {{provider.curso.nomePeriodos | lowercase}} válido para esta disciplina
		</div>
		<div *ngIf="form.controls['periodo'].errors.min">
			Mínimo 1 período
		</div>
	</div>


	<div class="form-group">
		<label for="nome">*Nome:</label>
		<input type="text" class="form-control" name="nome" [(ngModel)]="objetoDisciplina.nome" formControlName="nome" placeholder="Digite o nome da disciplina">
	</div>
	<div *ngIf="form.controls['nome'].invalid && (form.controls['nome'].dirty || form.controls['nome'].touched)" class="alert alert-danger" role="alert">
		<strong>Erros:</strong>
		<div *ngIf="form.controls['nome'].errors.required">
			Você deve preencher o nome da disciplina
		</div>
		<div *ngIf="form.controls['nome'].errors.maxlength">
			Informe um nome para a disciplina com no máximo de 100 caracteres
		</div>
	</div>

	<div class="form-group">
		<label for="creditos">*Quantidade de créditos semanais:</label>
		<input type="number" class="form-control" name="creditos" id="creditos" min="1" [(ngModel)]="objetoDisciplina.creditos" formControlName="creditos" placeholder="Digite a quantidade">
	</div>
	<div *ngIf="form.controls['creditos'].invalid && (form.controls['creditos'].dirty || form.controls['creditos'].touched)" class="alert alert-danger" role="alert">
		<strong>Erros:</strong>
		<div *ngIf="form.controls['creditos'].errors.required">
			Você deve preencher a quantidade de créditos
		</div>
		<div *ngIf="form.controls['creditos'].errors.max">
			Máximo 127 créditos
		</div>
		<div *ngIf="form.controls['creditos'].errors.min">
			Mínimo 1 crédito
		</div>
	</div>

	<div class="form-group">
		<label for="cargaHoraria">*Carga horária total (em horas):</label>
		<input type="number" class="form-control" name="cargaHoraria" min="1" [(ngModel)]="objetoDisciplina.cargaHoraria" formControlName="cargaHoraria" placeholder="Digite a carga horária">
	</div>
	<div *ngIf="form.controls['cargaHoraria'].invalid && (form.controls['cargaHoraria'].dirty || form.controls['cargaHoraria'].touched)" class="alert alert-danger" role="alert">
		<strong>Erros:</strong>
		<div *ngIf="form.controls['cargaHoraria'].errors.required">
			Você deve preencher a carga horária total da disciplina
		</div>
		<div *ngIf="form.controls['cargaHoraria'].errors.max">
			Máximo {{provider.curso.cargaMinima}} horas de carga horária
		</div>
		<div *ngIf="form.controls['cargaHoraria'].errors.min">
			Mínimo 1 hora
		</div>
	</div>
	<div class="form-group">
		<label for="cor">*Cor da disciplina:</label>
		<div class="container">
			<label class="cor-0-botao">
				<input type="radio" name="cor" value="0" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 0"><span></span></div>
			</label>
			<label class="cor-1-botao">
				<input type="radio" name="cor" value="1" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 1"><span></span></div>
			</label>
			<label class="cor-2-botao">
				<input type="radio" name="cor" value="2" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 2"><span></span></div>
			</label>
			<label class="cor-3-botao">
				<input type="radio" name="cor" value="3" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 3"><span></span></div>
			</label>
			<label class="cor-4-botao">
				<input type="radio" name="cor" value="4" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 4"><span></span></div>
			</label>
			<label class="cor-5-botao">
				<input type="radio" name="cor" value="5" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 5"><span></span></div>
			</label>
			<label class="cor-6-botao">
				<input type="radio" name="cor" value="6" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 6"><span></span></div>
			</label>
			<label class="cor-7-botao">
				<input type="radio" name="cor" value="7" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 7"><span></span></div>
			</label>
			<label class="cor-8-botao">
				<input type="radio" name="cor" value="8" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 8"><span></span></div>
			</label>
			<label class="cor-9-botao">
				<input type="radio" name="cor" value="9" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 9"><span></span></div>
			</label>
			<label class="cor-10-botao">
				<input type="radio" name="cor" value="10" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 10"><span></span></div>
			</label>
			<label class="cor-11-botao">
				<input type="radio" name="cor" value="11" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 11"><span></span></div>
			</label>
			<label class="cor-12-botao">
				<input type="radio" name="cor" value="12" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 12"><span></span></div>
			</label>
			<label class="cor-13-botao">
				<input type="radio" name="cor" value="13" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 13"><span></span></div>
			</label>
			<label class="cor-14-botao">
				<input type="radio" name="cor" value="14" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 14"><span></span></div>
			</label>
			<label class="cor-15-botao">
				<input type="radio" name="cor" value="15" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 15"><span></span></div>
			</label>
			<label class="cor-16-botao">
				<input type="radio" name="cor" value="16" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 16"><span></span></div>
			</label>
			<label class="cor-17-botao">
				<input type="radio" name="cor" value="17" class="hidden" [(ngModel)]="objetoDisciplina.cor" formControlName="cor">
				<div class="layer"></div>
				<div class="button" [class.ativo]="objetoDisciplina.cor == 17"><span></span></div>
			</label>
		</div>
	</div>




	<h3>Requisitos</h3>
	<div *ngIf="objetoDisciplina != undefined">
		<div class="" *ngFor="let requisito of objetoDisciplina.requisitos; let i = index">
			<label for="tipoRequisito">Tipo Requisito</label>

			<select class="form-control col-sm-5" name="requisito.tipoRequisito-{{i}}" (ngModelChange)="valuechange($event, i)" [(ngModel)]="objetoDisciplina.requisitos[i].tipoRequisito" [ngModelOptions]="{standalone: true}">
				<option value="">---Selecione---</option>
				<option value="1">Pré-Requisito</option>
				<option value="2">Co-Requisito</option>
			</select>

			<div class="alert alert-danger text-center" *ngIf="estaBloqueado(i)">
				<span>Ao alterar o tipo de requisito você deve atualizar também a disciplina</span>
			</div>

			<label for="disciplina">Disciplina</label>
			<!--inserir no name do select: -{{i}} para atualizar a lista-->
			<select class="form-control col-sm-5" id="disciplinaRequisito" name="idRequisito-{{i}}" [(ngModel)]="objetoDisciplina.requisitos[i].idRequisito" [ngModelOptions]="{standalone: true}">
				<option *ngFor="let disciplina of getPossiveis(objetoDisciplina.requisitos[i].tipoRequisito)" [value]="disciplina.id">[{{disciplina.periodo}}]-{{disciplina.nome}}</option>
			</select>

			<div class="form-btn col-sm-2 mt-btn-form-2">
				<button type="button" class="btn btn-danger" name="button" (click)="removerRequisito(i)">Remover</button>
			</div>


		</div>
	</div>
	<ng-container *ngIf="objetoDisciplina.periodo">
		<button type="button" class="btn btn-primary" name="button" (click)="adicionarRequisito()" [disabled]='provider.curso == undefined'>Adicionar Requisito</button><br><br>
	</ng-container>
	<div class="alert alert-warning" role="alert" *ngIf="!objetoDisciplina.periodo">
		Você deve preencher o {{provider.curso.nomePeriodos | lowercase}} da disciplina para adicionar um requisito
	</div>
	*São campos de preenchimento obrigatório<br><br>
	<button class="btn btn-success" type="submit" [disabled]="form == undefined || !form.valid || algumBloqueado()">Salvar</button>
	<button class="btn btn-secondary" type="button" (click)="voltar()" >Voltar</button>


</form>
